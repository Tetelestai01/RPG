<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>RPG Betsim - Aventura</title>
<style>
body {font-family:'Segoe UI',sans-serif; margin:0; padding:0; background:#f5f5f5; color:#333;}
#hud {display:flex; justify-content:space-between; padding:10px; background:#ddd; font-weight:bold; flex-wrap:wrap;}
#gameScreen {padding:10px;}
button {margin:5px; padding:10px; border:none; border-radius:5px; background:#666; color:white; font-weight:bold;}
button:hover{background:#444; cursor:pointer;}
input {margin:5px; padding:5px; border-radius:3px; border:1px solid #ccc;}
.hidden{display:none;}
#inventory, #hand, #menu{border:1px solid #aaa; padding:5px; margin:5px; border-radius:5px; background:#eee;}
#battleLog{border:1px solid #aaa; padding:5px; margin:5px; height:150px; overflow-y:auto; background:#fff;}
</style>
</head>
<body>

<div id="hud" class="hidden">
<span id="playerName"></span>
<span id="playerStats"></span>
<span id="playerPV"></span>
<span id="playerXP"></span>
<span id="playerGold"></span>
<span id="playerHand"></span>
<button onclick="openMenu()">Menu</button>
</div>

<div id="gameScreen">
  <div id="startScreen">
    <h1>RPG Betsim - Aventura</h1>
    <button onclick="startCharacterCreation()">Criar Ficha</button>
  </div>

  <div id="createScreen" class="hidden">
    <h2>Criar Ficha</h2>
    <label>Nome: <input type="text" id="charName"></label><br>
    <label>Distribua 10 pontos:</label><br>
    Vigor <span id="vigorValue">0</span> <button onclick="addPoint('vigor')">+</button><br>
    Força <span id="forcaValue">0</span> <button onclick="addPoint('forca')">+</button><br>
    Destreza <span id="destrezaValue">0</span> <button onclick="addPoint('destreza')">+</button><br>
    Armadura <span id="armaduraValue">0</span> <button onclick="addPoint('armadura')">+</button><br>
    <button onclick="finishCharacter()">Finalizar Ficha</button>
  </div>

  <div id="gameplay" class="hidden">
    <div id="locationScreen"></div>
    <div id="battleLog" class="hidden"></div>
  </div>

  <div id="menuScreen" class="hidden">
    <button onclick="resumeGame()">Continuar</button>
    <button onclick="restartGame()">Reiniciar Jogo</button>
    <button onclick="exitGame()">Sair do Jogo</button>
  </div>

</div>

<script>
// --- Player inicial ---
let player = {
    name:'',
    vigor:0,
    forca:0,
    destreza:0,
    armadura:0,
    pv:0,
    gold:50,
    xp:0,
    level:1,
    hand:null,
    weapon:null,
    inventory:[null,null,null]
};

let totalPoints = 10;
let exploredLocations = {};
let propinaBonusActive = false;

// --- Criação de ficha ---
function startCharacterCreation(){
    document.getElementById('startScreen').classList.add('hidden');
    document.getElementById('createScreen').classList.remove('hidden');
}

function addPoint(attr){
    let sum = player.vigor + player.forca + player.destreza + player.armadura;
    if(sum >= totalPoints) return alert('Todos os pontos distribuídos');
    player[attr]++;
    document.getElementById(attr+'Value').innerText = player[attr];
}

function finishCharacter(){
    const name = document.getElementById('charName').value;
    if(!name) return alert('Digite o nome do personagem');
    const sum = player.vigor + player.forca + player.destreza + player.armadura;
    if(sum < totalPoints) return alert('Distribua todos os pontos');
    player.name = name;
    player.pv = player.vigor * 10;
    document.getElementById('createScreen').classList.add('hidden');
    document.getElementById('hud').classList.remove('hidden');
    document.getElementById('gameplay').classList.remove('hidden');
    updateHUD();
    startAdventure();
}

// --- HUD ---
function updateHUD(){
    document.getElementById('playerName').innerText = player.name;
    document.getElementById('playerPV').innerText = `PV: ${player.pv}`;
    document.getElementById('playerGold').innerText = `Ouro: ${player.gold}`;
    document.getElementById('playerXP').innerText = `XP: ${player.xp}`;
    document.getElementById('playerStats').innerText = `F(${player.forca + (player.weapon?player.weapon.forceBonus:0)}), V(${player.vigor}), D(${player.destreza}), A(${player.armadura})`;
    document.getElementById('playerHand').innerText = `Mão: ${player.hand ? player.hand.name : 'vazio'}`;
}

// --- Menu ---
function openMenu(){
    document.getElementById('menuScreen').classList.remove('hidden');
}
function resumeGame(){
    document.getElementById('menuScreen').classList.add('hidden');
}
function restartGame(){
    location.reload();
}
function exitGame(){
    if(confirm('Deseja realmente sair? Toda ficha será perdida.')){
        location.reload();
    }
}

// --- Sistema de XP ---
function gainXP(sourceType, value, extraData=null){
    let xpGain = value;
    if(sourceType==='explore'){
        const loc = extraData;
        if(exploredLocations[loc]) return;
        exploredLocations[loc] = true;
        alert(`Você ganhou ${xpGain} XP explorando ${loc}!`);
    }
    if(sourceType==='propina' && propinaBonusActive){
        xpGain *= 2;
        alert(`XP dobrado por propina! Você ganhou ${xpGain} XP.`);
    }
    player.xp += xpGain;
    updateHUD();
    checkLevelUp();
}
function checkLevelUp(){
    let nextXP = getXPForNextLevel(player.level);
    if(player.xp >= nextXP){
        player.level++;
        player.xp -= nextXP;
        alert(`Parabéns! Subiu para o nível ${player.level}!`);
        allocateAttributePoint();
        updateHUD();
        checkLevelUp();
    }
}
function getXPForNextLevel(level){
    return Math.floor(100 * Math.pow(1.5, level-1));
}
function allocateAttributePoint(){
    const attr = prompt(`Distribua 1 ponto em: vigor, forca, destreza ou armadura`).toLowerCase();
    if(attr==='vigor') player.vigor++;
    else if(attr==='forca') player.forca++;
    else if(attr==='destreza') player.destreza++;
    else if(attr==='armadura') player.armadura++;
    else alert('Atributo inválido, ponto perdido');
    player.pv = player.vigor*10;
}

// --- Início da aventura ---
function startAdventure(){
    document.getElementById('locationScreen').innerHTML = `<h2>O Rei Robert convoca você para recuperar os 4 artefatos da chave!</h2>
    <button onclick="goToLocation('cidade')">Ir à Cidade</button>
    <button onclick="goToLocation('floresta')">Explorar Floresta</button>
    <button onclick="goToLocation('biblioteca')">Ir à Biblioteca</button>`;
}

// --- Exploração ---
function goToLocation(loc){
    let content = '';
    if(loc==='cidade'){
        content = `<h3>Cidade de Betsim</h3>
        <button onclick="gainXP('explore', 20,'cidade')">Explorar ruas</button>`;
    } else if(loc==='floresta'){
        if(!player.weapon) alert('Cuidado! Você está sem espada.');
        content = `<h3>Floresta</h3>
        <button onclick="gainXP('explore', 40,'floresta')">Explorar trilhas</button>`;
    } else if(loc==='biblioteca'){
        content = `<h3>Biblioteca</h3>
        <button onclick="gainXP('explore', 50,'biblioteca')">Pesquisar livros</button>`;
    }
    document.getElementById('locationScreen').innerHTML = content;
    updateHUD();
}

// --- Propina (Easter Egg) ---
function activatePropina(){
    if(player.gold<=20 && player.hand && player.hand.name==='ouro'){
        propinaBonusActive=true;
        alert('Easter egg ativado! Sistema de propina desbloqueado.');
    }
}
</script>

</body>
</html>
