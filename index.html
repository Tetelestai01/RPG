<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RPG Betsim - Missão da Chave</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:"Segoe UI",Arial,sans-serif;background:#f4f4f4;color:#2c3e50;padding-top:90px;}
header{position:fixed;top:0;left:0;width:100%;background:#2c3e50;color:white;padding:10px;font-size:16px;text-align:center;z-index:1000;display:flex;justify-content:space-between;align-items:center;}
header span{margin:0 10px;}
main{padding:20px;}
.card{background:white;border-radius:12px;padding:20px;margin:20px auto;max-width:500px;box-shadow:0 3px 8px rgba(0,0,0,0.1);}
.btn{display:inline-block;margin:5px;padding:12px 18px;font-size:16px;border:none;border-radius:10px;background:#8e44ad;color:white;cursor:pointer;transition:all 0.2s;}
.btn:hover{background:#71368a;}
.btn:active{transform:scale(0.96);}
.btn-secondary{background:#95a5a6;}
.btn-danger{background:#e74c3c;}
.hidden{display:none;}
.form-group{margin-bottom:12px;}
.form-group label{display:block;font-size:14px;margin-bottom:4px;color:#34495e;}
.form-group input{width:100%;padding:8px 10px;border:1px solid #ccd1d9;border-radius:6px;font-size:14px;}
#mensagem,#mensagemBatalha,#mensagemConversa{margin:10px 0;padding:10px;background:#ecf0f1;border-radius:6px;white-space:pre-wrap;max-height:300px;overflow-y:auto;}
ul{padding-left:20px;}
#menuOpcao{position:fixed;top:50px;right:10px;background:#34495e;color:white;padding:10px;border-radius:8px;display:none;z-index:1001;}
#menuOpcao button{display:block;width:100%;margin:5px 0;}
</style>
</head>
<body>

<header>
<span id="nomeJogador">Jogador</span>
<span id="atributosJogador">PV:0 Ouro:50</span>
<div>
<button class="btn-secondary" onclick="abrirPerfil()">Perfil</button>
<button class="btn-secondary" onclick="toggleMenu()">Menu</button>
</div>
</header>

<div id="menuOpcao">
<button class="btn" onclick="pauseJogo()">Pause</button>
<button class="btn-danger" onclick="sairJogo()">Sair do Jogo</button>
<button class="btn-secondary" onclick="reiniciarJogo()">Reiniciar Ficha</button>
<button class="btn-secondary" onclick="toggleMenu()">Fechar Menu</button>
</div>

<main>
<div id="telaInicial" class="card">
<h1>RPG Betsim</h1>
<p>O Rei Robert te convoca para uma missão de extrema importância: reunir os quatro artefatos da chave da grande caverna e derrotar o dragão de Luparus.</p>
<div id="menuInicial">
<button class="btn" id="btnCriarFicha" onclick="editarFicha()">Criar Ficha</button>
<button class="btn hidden" id="btnIniciarJogo" onclick="iniciarJogo()">Iniciar Aventura</button>
</div>
<div id="msgCrieFicha">Crie seu personagem para iniciar o jogo.</div>
</div>

<div id="telaFicha" class="card hidden">
<h2>Criação de Personagem</h2>
<div class="form-group">
<label>Nome do Jogador:</label>
<input type="text" id="inputNome" placeholder="Digite seu nome">
</div>
<div>Pontos disponíveis: <span id="pontosDisponiveis">10</span></div>
<div class="form-group"><label>Vigor (PV = Vigor*10)</label><input type="number" id="attrVigor" min="0" max="10" value="0" onchange="atualizaPontos()"></div>
<div class="form-group"><label>Força</label><input type="number" id="attrForca" min="0" max="10" value="0" onchange="atualizaPontos()"></div>
<div class="form-group"><label>Destreza</label><input type="number" id="attrDestreza" min="0" max="10" value="0" onchange="atualizaPontos()"></div>
<div class="form-group"><label>Armadura</label><input type="number" id="attrArmadura" min="0" max="10" value="0" onchange="atualizaPontos()"></div>
<button class="btn" onclick="salvarFicha()">Salvar Ficha</button>
<button class="btn-secondary" onclick="voltarMenu()">Voltar</button>
<div id="mensagemFicha"></div>
</div>

<div id="telaJogo" class="card hidden">
<div id="mensagem"></div>
<div id="opcoesJogo"></div>
</div>

<div id="telaBatalha" class="card hidden">
<h2>Batalha!</h2>
<div id="mensagemBatalha"></div>
<div id="rolagemDados" style="font-size:20px;margin:10px 0;"></div>
<button class="btn" id="btnRolar" onclick="iniciarTurno()">Iniciar Turno</button>
<button class="btn-secondary" onclick="voltarJogo()">Voltar</button>
</div>

<div id="telaPerfil" class="card hidden">
<h2>Perfil do Jogador</h2>
<div id="perfilAtributos"></div>
<div id="inventario">
<h3>Inventário (3 itens)</h3>
<ul id="listaItens"></ul>
</div>
<div id="mao">
<h3>Mão</h3>
<p id="itemMao">Vazio</p>
<button class="btn" onclick="usarItemMao()">Usar item</button>
<button class="btn-secondary" onclick="removerItemMao()">Descartar item</button>
</div>
<button class="btn-secondary" onclick="fecharPerfil()">Voltar</button>
</div>

<script>
// --- Dados iniciais ---
let jogador={nome:"",vigor:0,forca:0,destreza:0,armadura:0,pv:0,nivel:1,xp:0,ouro:50,inventario:[null,null,null],mao:null,chave:[false,false,false,false]};
let inimigo;
let rolando=false;

// --- Inicial ---
window.onload=function(){
if(localStorage.getItem("jogador")){
jogador=JSON.parse(localStorage.getItem("jogador"));
atualizarHUD();
document.getElementById("btnIniciarJogo").classList.remove("hidden");
document.getElementById("btnCriarFicha").classList.add("hidden");
document.getElementById("msgCrieFicha").classList.add("hidden");
}else{document.getElementById("atributosJogador").innerText=`PV:0 Ouro:50`;}
};

// --- HUD ---
function atualizarHUD(){
document.getElementById("nomeJogador").innerText=jogador.nome;
document.getElementById("atributosJogador").innerText=`PV:${jogador.pv} Ouro:${jogador.ouro}`;
atualizarPerfil();
}

// --- Ficha ---
function atualizaPontos(){
let v=parseInt(document.getElementById("attrVigor").value)||0;
let f=parseInt(document.getElementById("attrForca").value)||0;
let d=parseInt(document.getElementById("attrDestreza").value)||0;
let a=parseInt(document.getElementById("attrArmadura").value)||0;
let total=v+f+d+a;
document.getElementById("pontosDisponiveis").innerText=10-total;
document.getElementById("mensagemFicha").innerText=(total>10?"Você excedeu os pontos!":"");
}

function salvarFicha(){
let total=parseInt(document.getElementById("attrVigor").value||0)+parseInt(document.getElementById("attrForca").value||0)+parseInt(document.getElementById("attrDestreza").value||0)+parseInt(document.getElementById("attrArmadura").value||0);
if(total>10){alert("Distribua corretamente os 10 pontos.");return;}
jogador.nome=document.getElementById("inputNome").value||"Jogador";
jogador.vigor=parseInt(document.getElementById("attrVigor").value)||0;
jogador.forca=parseInt(document.getElementById("attrForca").value)||0;
jogador.destreza=parseInt(document.getElementById("attrDestreza").value)||0;
jogador.armadura=parseInt(document.getElementById("attrArmadura").value)||0;
jogador.pv=jogador.vigor*10;
localStorage.setItem("jogador",JSON.stringify(jogador));
atualizarHUD();
alert("Ficha salva!");
document.getElementById("telaFicha").classList.add("hidden");
document.getElementById("telaInicial").classList.remove("hidden");
document.getElementById("btnIniciarJogo").classList.remove("hidden");
document.getElementById("btnCriarFicha").classList.add("hidden");
document.getElementById("msgCrieFicha").classList.add("hidden");
}

function editarFicha(){
document.getElementById("telaInicial").classList.add("hidden");
document.getElementById("telaFicha").classList.remove("hidden");
document.getElementById("inputNome").value=jogador.nome;
document.getElementById("attrVigor").value=jogador.vigor;
document.getElementById("attrForca").value=jogador.forca;
document.getElementById("attrDestreza").value=jogador.destreza;
document.getElementById("attrArmadura").value=jogador.armadura;
atualizaPontos();
}

// --- Menu ---
function toggleMenu(){document.getElementById("menuOpcao").style.display=document.getElementById("menuOpcao").style.display=="none"?"block":"none";}
function pauseJogo(){ alert("Jogo pausado."); toggleMenu();}
function sairJogo(){ if(confirm("Deseja realmente sair do jogo? Toda ficha será apagada.")){localStorage.removeItem("jogador");location.reload();} }
function reiniciarJogo(){ if(confirm("Deseja reiniciar e criar nova ficha?")){localStorage.removeItem("jogador");location.reload();} }

function iniciarJogo(){
document.getElementById("telaInicial").classList.add("hidden");
document.getElementById("telaJogo").classList.remove("hidden");
mensagemJogo("O Rei Robert te convoca! Sua missão é reunir os 4 pedaços da chave para derrotar o dragão de Luparus.");
cidade();
}

// --- Perfil e Inventário ---
function abrirPerfil(){document.getElementById("telaPerfil").classList.remove("hidden");document.getElementById("telaJogo").classList.add("hidden");atualizarPerfil();}
function fecharPerfil(){document.getElementById("telaPerfil").classList.add("hidden");document.getElementById("telaJogo").classList.remove("hidden");cidade();}

function atualizarPerfil(){
let html=`<p>Nome: ${jogador.nome}</p>
<p>Nível: ${jogador.nivel} XP: ${jogador.xp}</p>
<p>PV: ${jogador.pv}</p>
<p>Vigor: ${jogador.vigor}, Força: ${jogador.forca}, Destreza: ${jogador.destreza}, Armadura: ${jogador.armadura}</p>
<p>Ouro: ${jogador.ouro}</p>`;
document.getElementById("perfilAtributos").innerHTML=html;
let lista=document.getElementById("listaItens");
lista.innerHTML="";
jogador.inventario.forEach((item,index)=>{
lista.innerHTML+=`<li>${item||"Vazio"} 
<button class="btn-secondary" onclick="colocarMao(${index})">Colocar na mão</button>
<button class="btn-danger" onclick="descartarItem(${index})">Descartar</button></li>`;
});
document.getElementById("itemMao").innerText=jogador.mao||"Vazio";
}

// --- Itens Mão ---
function colocarMao(index){
if(!jogador.inventario[index]) return;
jogador.mao=jogador.inventario[index];
atualizarPerfil();
alert(`Item ${jogador.mao} colocado na mão.`);
}

function usarItemMao(){
if(!jogador.mao){alert("Nenhum item na mão.");return;}
if(jogador.mao.includes("Poção")){
jogador.pv+=10;
if(jogador.pv>jogador.vigor*10) jogador.pv=jogador.vigor*10;
let idx=jogador.inventario.indexOf(jogador.mao);
if(idx!==-1) jogador.inventario[idx]=null;
alert("Poção usada! PV aumentado em 10.");
jogador.mao=null;
atualizarHUD();
}else{alert("Somente poções podem ser usadas. Para espada, vá para batalha.");}
}

function removerItemMao(){
if(!jogador.mao){alert("Nenhum item na mão.");return;}
if(confirm(`Deseja descartar ${jogador.mao}?`)){
let idx=jogador.inventario.indexOf(jogador.mao);
if(idx!==-1) jogador.inventario[idx]=null;
jogador.mao=null;
atualizarPerfil();
alert("Item descartado.");
}
}

// --- Locais, Loja e Batalhas ---
function mensagemJogo(msg){document.getElementById("mensagem").innerText=msg;}
function addBtn(text,func){let b=document.createElement("button");b.className="btn";b.innerText=text;b.onclick=func;document.getElementById("opcoesJogo").appendChild(b);}
function voltarMenu(){document.getElementById("telaFicha").classList.add("hidden");document.getElementById("telaInicial").classList.remove("hidden");}
function voltarJogo(){document.getElementById("telaBatalha").classList.add("hidden");document.getElementById("telaJogo").classList.remove("hidden");}

function cidade(){
mensagemJogo("Você está na cidade de Betsim. Onde deseja ir?");
document.getElementById("opcoesJogo").innerHTML='';
addBtn("Ir para Floresta",()=>floresta());
addBtn("Conversar com aldeão",()=>conversaNPC());
addBtn("Checar inventário",()=>abrirPerfil());
}

function floresta(){
if(!jogador.mao || !jogador.mao.includes("Espada")){
alert("Cuidado! Você está sem espada.");
}
mensagemJogo("Você entrou na floresta...");
document.getElementById("opcoesJogo").innerHTML='';
addBtn("Explorar e procurar artefato",()=>encontro());
addBtn("Voltar à cidade",()=>cidade());
}

function conversaNPC(){
mensagemJogo("O aldeão diz: Posso te vender uma espada ou poção.");
document.getElementById("opcoesJogo").innerHTML='';
addBtn("Ir à loja",()=>loja());
addBtn("Voltar",()=>cidade());
}

function loja(){
mensagemJogo("Loja: Você pode comprar itens.");
document.getElementById("opcoesJogo").innerHTML='';
addBtn("Comprar Espada (+2 Força) - 20 ouro",()=>comprarItem("Espada +2",20));
addBtn("Comprar Poção (+10 PV) - 10 ouro",()=>comprarItem("Poção +10PV",10));
addBtn("Voltar",()=>cidade());
}

function comprarItem(item,preco){
if(jogador.ouro>=preco){
jogador.ouro-=preco;
for(let i=0;i<3;i++){
if(!jogador.inventario[i]){jogador.inventario[i]=item;break;}
}
alert(`${item} comprado!`);
atualizarHUD();
}else{alert("Ouro insuficiente!");}
}

// --- Batalha ---
function encontro(){
inimigo={nome:"Goblin",vigor:2,forca:2,destreza:2,armadura:1,pv:20};
document.getElementById("telaJogo").classList.add("hidden");
document.getElementById("telaBatalha").classList.remove("hidden");
document.getElementById("rolagemDados").innerHTML='';
document.getElementById("mensagemBatalha").innerText=`Você encontrou um ${inimigo.nome}!\nPV: ${inimigo.pv}`;
}

// --- Rolagem de Dados ---
function iniciarTurno(){
if(rolando) return;
rolando=true;
let dadoAtaque=Math.floor(Math.random()*6)+1;
let dadoDefesa=Math.floor(Math.random()*6)+1;
let ataque=jogador.destreza+dadoAtaque;
let defesa=inimigo.armadura+dadoDefesa;
let dano=Math.max(0,ataque-inimino.armadura);
document.getElementById("rolagemDados").innerText=`Ataque: ${dadoAtaque}+${jogador.destreza}=${ataque}\nDefesa inimigo: ${inimigo.armadura}+${dadoDefesa}=${defesa}\nDano causado: ${dano}`;
inimigo.pv-=dano;
if(inimigo.pv<=0){alert("Você derrotou o inimigo!");voltarJogo();rolando=false;return;}
rolando=false;
}
</script>
</body>
</html>
